---
import Layout from '../layouts/Layout.astro';
import ProjectGrid from '../components/ProjectGrid'; // Import the new grid component

const GITHUB_USERNAME = 'alphatra';

// Fetch GitHub repos at build time (with topics; GitHub API requires preview header to include topics in REST v3)
let githubRepos = [];
let githubError = null;
try {
  const githubRes = await fetch(`https://api.github.com/users/${GITHUB_USERNAME}/repos?sort=updated&type=public`, {
    headers: {
      'Accept': 'application/vnd.github.mercy-preview+json'
    }
  });
  if (githubRes.ok) {
    githubRepos = await githubRes.json();
  } else {
    githubError = `GitHub API error: ${githubRes.status}`;
  }
} catch (error) {
  githubError = `Failed to fetch GitHub data: ${error.message}`;
}

// Define filters here, pass to ProjectGrid
const filters = ['All', 'Artificial Intelligence', 'Developer Platform', 'Enterprise Software', 'Information Technology', 'Search Engine'];
---
<Layout title="Projects - Gracjan">
  <div class="container mx-auto px-4 py-12">
    <h1 class="text-4xl font-bold mb-6">Projects</h1>

    {/* Render the interactive ProjectGrid component */}
    <ProjectGrid
      client:load {/* Load immediately for interactivity */}
      githubRepos={githubRepos}
      githubError={githubError}
      filters={filters}
    />

    {/* Interaktywny grid + filtry, sortowanie i wyszukiwanie w komponencie */}

  </div>
</Layout> 